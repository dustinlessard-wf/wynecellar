define(["jquery","underscore","backbone","stackmob","text!templates/login/loginTemplate.html","libs/app/util"],function(e,t,n,r,i,s){var o=n.View.extend({className:"loginView",events:{"click #submitLogin":"login"},initialize:function(){this.collection=this.options.collection,this.router=this.options.router},render:function(){var e=this.$el;return e.empty(),e.append(i),e.attr("data-role","dialog"),e.attr("data-theme","b"),this},login:function(t){var n=this.collection,r=s("#loginForm").serializeObject(),i=this.router,o=this.$el;t.preventDefault(),e.mobile.loading("show",{text:"Logging In!",textVisible:!0,theme:"b"}),e("#loginBtn").addClass("disabled"),e("#loginBtn").attr("disabled",!0);var u=new StackMob.User(r);return u.login(!1,{success:function(t){StackMob.LoggedInUserObject=t,e.mobile.loading("hide");var r=new StackMob.Collection.Query;r.setExpand(1),n.query(r),i.navigate("#wine/true",{trigger:!0}),e("input.usernameLogin").val(""),e("input.passwordLogin").val("")},error:function(t){e.mobile.loading("hide");var n=o.find(":jqmData(role='content')");n.prepend("<h5 align='center'>"+t.error_description+"</h5")}}),this}});return o});